<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>éšœå®³ã‚¿ã‚¤ãƒ æ¯”è¨ˆç®—ãƒ„ãƒ¼ãƒ«</title>
    <style>
        :root { --primary: #1b4332; --bg: #f4f7f6; --accent: #2980b9; }
        body { font-family: -apple-system, sans-serif; background: var(--bg); margin: 0; padding: 10px; color: #2c3e50; }
        .container { max-width: 500px; margin: 0 auto; }
        .card { background: white; padding: 18px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); margin-bottom: 15px; }
        h3 { margin-top: 0; color: var(--primary); font-size: 16px; border-bottom: 1px solid #eee; padding-bottom: 10px; margin-bottom: 15px; }
        
        label { display: block; font-size: 12px; font-weight: bold; color: #7f8c8d; margin-top: 10px; margin-bottom: 4px; }
        select, input { width: 100%; padding: 12px; border: 1px solid #cbd5e0; border-radius: 4px; font-size: 16px; box-sizing: border-box; background-color: white; }
        
        .btn-main { width: 100%; background: var(--primary); color: white; padding: 16px; border: none; border-radius: 4px; font-size: 16px; font-weight: bold; cursor: pointer; margin-top: 15px; }
        
        .record-info-box { font-size: 13px; color: #4a5568; background: #f8f9fa; padding: 12px; border-radius: 4px; margin-top: 10px; border-left: 4px solid var(--primary); display: none; line-height: 1.5; }
        
        #resultArea { margin-top: 20px; border-top: 2px solid #eee; padding-top: 15px; display: none; text-align: center; }
        .ratio-val { font-size: 32px; font-weight: bold; color: var(--primary); margin: 5px 0; }
        .rank-badge { display: inline-block; padding: 4px 12px; border-radius: 20px; font-size: 14px; font-weight: bold; margin-bottom: 10px; }
        
        .rank-s { background: #fff5f5; color: #c53030; border: 1px solid #feb2b2; }
        .rank-a { background: #fffaf0; color: #c05621; border: 1px solid #fbd38d; }
        .rank-b { background: #f0fff4; color: #276749; border: 1px solid #9ae6b4; }
        .rank-c { background: #edf2f7; color: #4a5568; border: 1px solid #cbd5e0; }

        details { background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); margin-top: 10px; overflow: hidden; }
        summary { padding: 15px; font-size: 14px; font-weight: bold; color: var(--primary); cursor: pointer; list-style: none; border-bottom: 1px solid #eee; }
        .record-list-content { padding: 10px; background: #fff; font-size: 11px; max-height: 500px; overflow-y: auto; }
        
        table { width: 100%; border-collapse: collapse; margin-bottom: 15px; table-layout: fixed; }
        th { background: #f1f3f1; color: var(--primary); text-align: left; padding: 8px 4px; font-size: 10px; border-bottom: 2px solid #ddd; }
        td { padding: 8px 4px; border-bottom: 1px solid #eee; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; text-align: left; }
        .venue-header { background: var(--primary); color: white; font-weight: bold; padding: 6px 10px; font-size: 12px; }
        
        .col-dist { width: 22%; }
        .col-time { width: 18%; font-weight: bold; }
        .col-horse { width: 35%; }
        .col-date { width: 25%; color: #7f8c8d; }
    </style>
</head>
<body>

<div class="container">
    <div class="card">
        <h3>éšœå®³ã‚¿ã‚¤ãƒ æ¯”è¨ˆç®—</h3>
        
        <label>ç«¶é¦¬å ´</label>
        <select id="venue" onchange="updateCourse()">
            <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
            <option value="nakayama">ä¸­å±±</option>
            <option value="tokyo">æ±äº¬</option>
            <option value="kyoto">äº¬éƒ½</option>
            <option value="hanshin">é˜ªç¥</option>
            <option value="niigata">æ–°æ½Ÿ</option>
            <option value="kokura">å°å€‰</option>
            <option value="fukushima">ç¦å³¶</option>
            <option value="chukyo">ä¸­äº¬</option>
        </select>

        <label>ã‚³ãƒ¼ã‚¹ / è·é›¢</label>
        <select id="course" onchange="displayRecord()">
            <option value="">ç«¶é¦¬å ´ã‚’å…ˆã«é¸ã‚“ã§ãã ã•ã„</option>
        </select>

        <div id="recordInfo" class="record-info-box"></div>

        <label>èµ°ç ´ã‚¿ã‚¤ãƒ  (ä¾‹ 3:15.2 ã¾ãŸã¯ 315.2)</label>
        <input type="text" id="timeInput" placeholder="åˆ†:ç§’.ãƒŸãƒª" inputmode="decimal">

        <button class="btn-main" onclick="calculate()">åˆ¤å®šã‚’å®Ÿè¡Œ</button>

        <div id="resultArea">
            <div id="rankBadge" class="rank-badge">---</div>
            <div class="ratio-val" id="ratioResult">0.00%</div>
            <div id="commentText" class="comment" style="font-size: 13px; color: #718096;"></div>
        </div>
    </div>

    <details>
        <summary>ğŸ“Š éšœå®³ã‚³ãƒ¼ã‚¹ ãƒ¬ã‚³ãƒ¼ãƒ‰ä¸€è¦§ã‚’è¡¨ç¤º</summary>
        <div class="record-list-content" id="masterRecordList"></div>
    </details>
</div>

<script>
const db = {
    nakayama: { label: "ä¸­å±±", data: [
        { name: "èŠ4260m", record: 290.5, date: "2025/4/19", horse: "ã‚¨ã‚³ãƒ­ãƒ‡ãƒ¥ã‚¨ãƒ«" },
        { name: "èŠ4250m", record: 283.0, date: "2018/4/14", horse: "ã‚ªã‚¸ãƒ¥ã‚¦ãƒãƒ§ã‚¦ã‚µãƒ³" },
        { name: "èŠ4100m", record: 276.1, date: "2017/12/23", horse: "ã‚ªã‚¸ãƒ¥ã‚¦ãƒãƒ§ã‚¦ã‚µãƒ³" },
        { name: "èŠ3570m", record: 237.9, date: "2023/12/2", horse: "ãƒ­ãƒƒã‚¯ãƒ¦ãƒ¼" },
        { name: "ãƒ€3550m", record: 238.1, date: "1984/1/15", horse: "ãƒã‚¤ãƒ†ã‚£ãƒ–ãƒœãƒ¼ã‚¤" },
        { name: "èŠ3370m", record: 225.4, date: "2002/11/30", horse: "ã‚®ãƒ«ãƒ‡ãƒƒãƒ‰ã‚¨ãƒ¼ã‚¸" },
        { name: "èŠ3350m", record: 220.8, date: "2004/12/4", horse: "ãƒ¡ã‚¸ãƒ­ã‚ªãƒ¼ãƒ¢ãƒ³ãƒ‰" },
        { name: "èŠ3210m", record: 209.3, date: "2024/9/21", horse: "ã‚¹ãƒã‚¤ãƒ«ã‚¹ãƒ«ãƒ¼" },
        { name: "ãƒ€3200m", record: 211.0, date: "1997/3/1", horse: "ã‚­ãƒ£ãƒ‹ã‚ªãƒ³ã‚¹ãƒˆãƒ¼ãƒ " },
        { name: "èŠ3030m", record: 200.3, date: "1999/9/19", horse: "ãƒªãƒ³ãƒ‡ãƒ³ãƒã‚¦ãƒ " },
        { name: "ãƒ€2880m", record: 190.2, date: "2006/4/2", horse: "ãƒã‚¤ãƒãƒ«ãƒ›ãƒ©ã‚¤ã‚ºãƒ³" },
        { name: "èŠ2710m", record: 182.2, date: "1999/4/4", horse: "ãƒã‚¤ãƒãƒ«ã‚¿ã‚¹ã‚¯" },
        { name: "ãƒ€2700m", record: 176.8, date: "1996/6/16", horse: "ãƒ‘ãƒ¯ãƒ¼ã‚¯ãƒªãƒ³ãƒˆ" }
    ]},
    kyoto: { label: "äº¬éƒ½", data: [
        { name: "èŠ3930m", record: 261.6, date: "2012/5/12", horse: "ã‚¨ãƒ ã‚¨ã‚¹ãƒ¯ãƒ¼ãƒ«ãƒ‰" },
        { name: "ãƒ€3790m", record: 255.0, date: "2007/2/10", horse: "ã‚¢ãƒ‰ãƒã‚¤ãƒ¤ãƒ›ãƒ¼ãƒ—" },
        { name: "ãƒ€3760m", record: 254.4, date: "2001/11/24", horse: "ã‚«ãƒãƒˆã‚·ã‚¬ãƒãƒŠãƒ¼" },
        { name: "ãƒ€3190m", record: 211.5, date: "2007/1/13", horse: "ãƒ•ãƒŸãƒãƒˆã‚­ãƒ¡ã‚­" },
        { name: "èŠ3180m", record: 213.5, date: "2000/10/28", horse: "ãƒ©ãƒ³ãƒ‰ãƒ‘ãƒ¯ãƒ¼" },
        { name: "èŠ3170m", record: 210.4, date: "2011/11/12", horse: "ãƒ†ã‚¤ã‚¨ãƒ ãƒãƒªã‚¢ãƒ¼" },
        { name: "ãƒ€3170m", record: 208.4, date: "1995/3/4", horse: "ãƒªã‚¿ãƒ¼ãƒ³ã‚¨ãƒ¼ã‚¹" },
        { name: "ãƒ€2930m", record: 192.2, date: "2010/1/17", horse: "ãƒ†ã‚¤ã‚¨ãƒ ãƒãƒªã‚¢ãƒ¼" },
        { name: "ãƒ€2910m", record: 191.2, date: "1996/1/20", horse: "ã‚µãƒ ã‚½ãƒ³ãƒ“ãƒƒã‚°" }
    ]},
    tokyo: { label: "æ±äº¬", data: [
        { name: "èŠ3300m", record: 215.1, date: "2007/6/9", horse: "ãƒ¡ãƒ«ã‚·ãƒ¼ã‚¨ã‚¤ã‚¿ã‚¤ãƒ " },
        { name: "ãƒ€3300m", record: 216.2, date: "2010/5/22", horse: "ã‚®ãƒ«ãƒ†ã‚£ã‚¹ãƒˆãƒ©ã‚¤ã‚¯" },
        { name: "ãƒ€3285m", record: 216.2, date: "2009/5/23", horse: "ã‚¨ã‚¤ã‚·ãƒ³ãƒœã‚¹ãƒˆãƒ³" },
        { name: "èŠ3110m", record: 203.6, date: "2023/11/4", horse: "ãƒ­ãƒ¼ãƒ‰ãƒˆã‚¥ãƒ•ã‚§ã‚¤ãƒ " },
        { name: "ãƒ€3100m", record: 202.0, date: "2013/5/18", horse: "ã‚¢ãƒ‰ãƒã‚¤ãƒ¤ãƒ„ãƒã‚µ" },
        { name: "ãƒ€3000m", record: 197.5, date: "2005/5/14", horse: "ã‚·ãƒ«ã‚¯ãƒªã‚¹ãƒšã‚¯ãƒˆ" }
    ]},
    hanshin: { label: "é˜ªç¥", data: [
        { name: "èŠ3900m", record: 259.1, date: "2020/3/14", horse: "ã‚ªã‚¸ãƒ¥ã‚¦ãƒãƒ§ã‚¦ã‚µãƒ³" },
        { name: "èŠ3800m", record: 258.1, date: "1999/3/14", horse: "ãƒ•ã‚¡ã‚¤ãƒ–ãƒã‚¤ãƒ³ã‚¿ãƒ¼" },
        { name: "èŠ3140m", record: 204.8, date: "2013/9/14", horse: "ã‚ªãƒ¼ã‚¹ãƒŸãƒ ãƒ¼ãƒ³" },
        { name: "ãƒ€3110m", record: 205.0, date: "2008/7/5", horse: "ãƒãƒˆãƒ«ãƒ–ãƒ¬ãƒ¼ãƒ´" },
        { name: "ãƒ€2970m", record: 195.7, date: "2007/9/22", horse: "ãƒ‘ãƒ«ãƒ†ã‚£ã‚¢ã‚·ãƒãƒ¼" }
    ]},
    kokura: { label: "å°å€‰", data: [
        { name: "èŠ3390m", record: 220.0, date: "2010/7/24", horse: "ãƒ©ãƒ³ãƒ˜ãƒ©ãƒ³ãƒ" },
        { name: "èŠ2900m", record: 187.1, date: "2008/8/9", horse: "ãƒ­ãƒ³ã‚°ã‚¢ã‚­ãƒ¬ã‚¹" },
        { name: "èŠ2860m", record: 186.3, date: "2022/8/13", horse: "ãƒªãƒãƒ¼ã‚·ãƒ–ãƒ«ãƒ¬ãƒ¼ãƒ³" }
    ]},
    niigata: { label: "æ–°æ½Ÿ", data: [
        { name: "èŠ3290m", record: 214.4, date: "2016/5/14", horse: "ãƒ¦ã‚­ãƒã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼" },
        { name: "èŠ3250m", record: 208.3, date: "2023/7/29", horse: "ã‚µã‚¯ã‚»ãƒƒã‚·ãƒ§ãƒ³" },
        { name: "èŠ2890m", record: 185.5, date: "2022/5/7", horse: "ã‚¼ãƒãƒ´ã‚¡ãƒ¼ã‚¹" },
        { name: "èŠ2850m", record: 181.4, date: "2002/7/27", horse: "ãƒ€ã‚¤ãƒ¯ã‚¦ã‚¤ãƒ³ãƒ€ãƒ " }
    ]},
    fukushima: { label: "ç¦å³¶", data: [
        { name: "èŠ3380m", record: 218.5, date: "2015/4/25", horse: "ãƒ©ãƒƒã‚­ãƒ¼ã‚¹ãƒˆãƒªãƒ¼ã‚¯" },
        { name: "èŠ3350m", record: 219.0, date: "2014/10/25", horse: "ã‚µãƒ³ãƒ©ã‚¤ã‚ºãƒ­ã‚¤ãƒ¤ãƒ«" },
        { name: "èŠ2800m", record: 181.8, date: "2014/11/15", horse: "ã‚¨ãƒ¼ã‚·ãƒ³ã‚¸ãƒ¼ãƒ©ã‚¤ãƒ³" },
        { name: "èŠ2770m", record: 179.3, date: "2015/4/25", horse: "ã‚µãƒŠã‚·ã‚ªãƒ³" },
        { name: "èŠ2750m", record: 177.2, date: "2024/4/6", horse: "ãƒ´ã‚§ã‚¤ãƒ«ãƒãƒ“ãƒ¥ãƒ©" }
    ]},
    chukyo: { label: "ä¸­äº¬", data: [
        { name: "èŠ3900m", record: 254.8, date: "2021/5/15", horse: "ãƒãƒ¼ãƒ‹" },
        { name: "èŠ3330m", record: 217.4, date: "2017/7/15", horse: "ãƒ¦ã‚¦ã‚­ãƒ“ãƒãƒ¯ãƒ³ãƒ€ãƒ¼" },
        { name: "èŠ3300m", record: 213.3, date: "2020/9/19", horse: "ã‚¿ã‚¬ãƒã‚¨ã‚¹ãƒ—ãƒ¬ãƒƒã‚½" },
        { name: "èŠ3000m", record: 195.8, date: "2024/8/18", horse: "ãƒ—ãƒªãƒ¢ã‚¹ãƒšãƒ©ãƒ³ãƒ„ã‚¡" }
    ]}
};

function initRecordList() {
    const listContainer = document.getElementById('masterRecordList');
    let html = "";
    for (const key in db) {
        html += `<div class="venue-header">${db[key].label}</div>`;
        html += `<table><thead><tr><th class="col-dist">è·é›¢</th><th class="col-time">ã‚¿ã‚¤ãƒ </th><th class="col-horse">ä¿æŒé¦¬</th><th class="col-date">è¨˜éŒ²æ—¥</th></tr></thead><tbody>`;
        db[key].data.forEach(item => {
            const m = Math.floor(item.record / 60);
            const s = (item.record % 60).toFixed(1);
            html += `<tr><td>${item.name}</td><td class="col-time">${m}:${s.padStart(4, '0')}</td><td>${item.horse}</td><td class="col-date">${item.date}</td></tr>`;
        });
        html += `</tbody></table>`;
    }
    listContainer.innerHTML = html;
}
initRecordList();

function updateCourse() {
    const venue = document.getElementById('venue').value;
    const courseSelect = document.getElementById('course');
    const recordBox = document.getElementById('recordInfo');
    courseSelect.innerHTML = '<option value="">ã‚³ãƒ¼ã‚¹ã‚’é¸æŠ</option>';
    recordBox.style.display = 'none';
    if (venue && db[venue]) {
        db[venue].data.forEach((item, index) => {
            const opt = document.createElement('option');
            opt.value = index;
            opt.innerText = item.name;
            courseSelect.appendChild(opt);
        });
    }
}

function displayRecord() {
    const venue = document.getElementById('venue').value;
    const index = document.getElementById('course').value;
    const recordBox = document.getElementById('recordInfo');
    if (venue && index !== "") {
        const data = db[venue].data[index];
        const m = Math.floor(data.record / 60);
        const s = (data.record % 60).toFixed(1);
        recordBox.innerHTML = `ğŸ <b>ãƒ¬ã‚³ãƒ¼ãƒ‰ï¼š${m}:${s.padStart(4, '0')}</b><br>ğŸ ${data.horse}<br>ğŸ“… ${data.date}`;
        recordBox.style.display = 'block';
    } else {
        recordBox.style.display = 'none';
    }
}

function calculate() {
    const venue = document.getElementById('venue').value;
    const index = document.getElementById('course').value;
    const timeVal = document.getElementById('timeInput').value.trim();

    if (!venue || index === "" || !timeVal) return alert("å…¥åŠ›ä¸è¶³ã§ã™");

    let totalSeconds = 0;
    if (timeVal.includes(':')) {
        const parts = timeVal.split(':');
        totalSeconds = (parseFloat(parts[0]) * 60) + parseFloat(parts[1]);
    } else {
        const m = Math.floor(parseFloat(timeVal) / 100);
        const s = parseFloat(timeVal) % 100;
        totalSeconds = (m * 60) + s;
    }

    if (isNaN(totalSeconds) || totalSeconds <= 0) return alert("ã‚¿ã‚¤ãƒ ã®å½¢å¼ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“");

    const record = db[venue].data[index].record;
    const ratio = (totalSeconds / record) * 100;
    
    document.getElementById('resultArea').style.display = 'block';
    document.getElementById('ratioResult').innerText = ratio.toFixed(2) + "%";
    
    const rb = document.getElementById('rankBadge');
    const ct = document.getElementById('commentText');
    rb.className = 'rank-badge';
    
    if (ratio < 101.5) {
        rb.innerText = "ãƒ©ãƒ³ã‚¯Sï¼šè¶…æŠœç´š"; rb.classList.add('rank-s');
        ct.innerText = "ç•°æ¬¡å…ƒã®æ™‚è¨ˆã§ã™ã€‚é‡è³åˆ¶è¦‡ãƒ¬ãƒ™ãƒ«ã€‚";
    } else if (ratio < 103.0) {
        rb.innerText = "ãƒ©ãƒ³ã‚¯Aï¼šå„ªç§€"; rb.classList.add('rank-a');
        ct.innerText = "æ˜‡ç´šã—ã¦ã‚‚å³å‹ã¡è² ã‘ã§ãã‚‹ã‚¹ãƒ”ãƒ¼ãƒ‰ã§ã™ã€‚";
    } else if (ratio < 104.5) {
        rb.innerText = "ãƒ©ãƒ³ã‚¯Bï¼šæ¨™æº–"; rb.classList.add('rank-b');
        ct.innerText = "ã“ã®ã‚¯ãƒ©ã‚¹ã®å¹³å‡çš„ãªæ°´æº–ã§ã™ã€‚";
    } else {
        rb.innerText = "ãƒ©ãƒ³ã‚¯Cï¼šä½èª¿"; rb.classList.add('rank-c');
        ct.innerText = "æ™‚è¨ˆã‚’è¦ã—ã¾ã—ãŸã€‚é¦¬å ´ã‚„ãƒŸã‚¹ã®æœ‰ç„¡ã‚’ç¢ºèªã€‚";
    }
}
</script>
</body>
</html>
